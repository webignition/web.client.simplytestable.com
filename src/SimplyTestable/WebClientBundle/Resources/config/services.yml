imports:
    - { resource: services/event-listeners.yml }
    - { resource: services/commands.yml }
    - { resource: services/controllers.yml }
    - { resource: services/resque-job-factory.yml }
    - { resource: services/redefinitions.yml }
    - { resource: services/configuration.yml }

services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  SimplyTestable\WebClientBundle\Services\ResqueQueueService:
    arguments:
      - '@resque'
      - '@logger'
      - '%kernel.environment%'

  webignition\SimplyTestableUserSerializer\UserSerializer:
    arguments:
      - '%secret%'

  SimplyTestable\WebClientBundle\Services\TestOptions\RequestAdapter:
    calls:
      - [addFeatureOptionsParser, ['@SimplyTestable\WebClientBundle\Services\TestOptions\OptionsParser']]
      - [addFeatureOptionsParser, ['@SimplyTestable\WebClientBundle\Services\TestOptions\CookieOptionsParser', 'cookies']]

  SimplyTestable\WebClientBundle\Services\MailChimp\ListRecipientsService:
    arguments:
      - '@doctrine.orm.entity_manager'
      - '@logger'
      -
        announcements: '%mailchimp_announcements_list_id%'
        updates: '%mailchimp_updates_list_id%'
        introduction: '%mailchimp_introduction_list_id%'

  SimplyTestable\WebClientBundle\Services\TaskTypeService:
    calls:
      - [setTaskTypes, ['%task_types%']]
      - [setEarlyAccessUsers, ['%early_access_users%']]

  SimplyTestable\WebClientBundle\Services\CouponService:
    calls:
      - [setCouponData, ['%coupons%']]

  SimplyTestable\WebClientBundle\Services\PlansService:
    calls:
      - [setPlansData, ['%plans%']]

  SimplyTestable\WebClientBundle\Services\TaskOutput\ResultParser\Factory:
    calls:
      - [addResultParser, ['@SimplyTestable\WebClientBundle\Services\TaskOutput\ResultParser\HtmlValidationResultParser']]
      - [addResultParser, ['@SimplyTestable\WebClientBundle\Services\TaskOutput\ResultParser\CssValidationResultParser']]
      - [addResultParser, ['@SimplyTestable\WebClientBundle\Services\TaskOutput\ResultParser\JsStaticAnalysisResultParser']]
      - [addResultParser, ['@SimplyTestable\WebClientBundle\Services\TaskOutput\ResultParser\LinkIntegrityResultParser']]

  SimplyTestable\WebClientBundle\Services\CoreApplicationRouter:
    arguments:
      - '%core_url%'
      - '@SimplyTestable\WebClientBundle\Services\ResourceLocator'
      - '%kernel.cache_dir%'

  SimplyTestable\WebClientBundle\Services\SystemUserService:
    arguments:
      - '%admin_user_username%'
      - '%admin_user_password%'

  SimplyTestable\WebClientBundle\Services\MailChimp\Client:
    arguments:
      - '%mailchimp_api_key%'

  Egulias\EmailValidator\EmailValidator:

  GuzzleHttp\Client:
    factory: 'SimplyTestable\WebClientBundle\Services\HttpClientFactory:getHttpClient'

  webignition\Guzzle\Middleware\HttpAuthentication\HttpAuthenticationMiddleware:
