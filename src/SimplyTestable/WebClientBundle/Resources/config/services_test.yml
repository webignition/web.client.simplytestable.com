services:
  SimplyTestable\WebClientBundle\Services\HttpClientFactory:
    public: true
    class:   Tests\WebClientBundle\Services\TestHttpClientFactory
    arguments:
      - '@webignition\HttpHistoryContainer\Container'
      - '@webignition\Guzzle\Middleware\HttpAuthentication\HttpAuthenticationMiddleware'
      - '@Tests\WebClientBundle\Services\HttpMockHandler'

  webignition\HttpHistoryContainer\Container:

  Tests\WebClientBundle\Services\HttpMockHandler:
    public: true

  # Need to inject our guzzle client into the postmark client to enable regular HTTP mocking in tests
  # We don't to this for the dev/prod service as Postmark\PostmarkClient depends on the client constructor being
  # passed the base url for correct behaviour.
  Postmark\PostmarkClient:
    public: true
    arguments:
      - '%postmark_api_key%'
    calls:
      - [setClient, ['@GuzzleHttp\Client']]

  Tests\WebClientBundle\Services\PostmarkMessageVerifier:
    public: true
